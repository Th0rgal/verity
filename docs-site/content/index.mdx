---
title: Dumb Contracts
description: Minimal Lean 4 EDSL for Smart Contracts with Formal Verification
---

# Dumb Contracts

**Minimal Lean 4 EDSL for Smart Contracts with Formal Verification**

> *From runtime testing to mathematical proof*

Dumb Contracts combines minimalism with mathematical rigor: an **82-line core** that handles realistic contracts, backed by **machine-checked formal proofs** of correctness.

## üéØ What Makes This Different?

- **Minimal Core**: Just 82 lines of Lean code
- **Proven Correct**: Machine-checked formal proofs, not just tests
- **Research-Driven**: 7 iterations documenting every design decision
- **Composable**: Patterns naturally combine without special support
- **Well-Tested**: 62 runtime tests + 11 formal proofs

## üí° The Value Proposition

### Before: Runtime Testing Only
```lean
def store (value : Uint256) : Contract Unit := ...
def retrieve : Contract Uint256 := ...
```
‚úÖ 4 Foundry tests pass
‚úÖ 256 fuzz runs
‚ùì *"Is it correct?"* ‚Üí **High confidence**

### Now: Testing + Formal Verification
```lean
theorem store_retrieve_correct (s : ContractState) (value : Uint256) :
  let s' := (store value).run s |>.2
  let result := retrieve.run s' |>.1
  result = value := by
  -- Machine-checked proof
```
‚úÖ 4 Foundry tests pass
‚úÖ 256 fuzz runs
‚úÖ **11 theorems proven**
‚ùì *"Is it correct?"* ‚Üí **Mathematical certainty**

## üìä Project Stats

| Metric | Value |
|--------|-------|
| Core lines | 82 |
| Stdlib lines | 63 (Math.lean) |
| Example contracts | 7 |
| Runtime tests | 62 (100% passing) |
| Fuzz tests | 11 |
| **Proven theorems** | **11 (SimpleStorage)** |

## üöÄ Quick Example

```lean
-- SimpleStorage contract with formal verification
def storedData : StorageSlot Uint256 := ‚ü®0‚ü©

def store (value : Uint256) : Contract Unit := do
  setStorage storedData value

def retrieve : Contract Uint256 := do
  getStorage storedData

-- PROVEN: After storing v, retrieve returns v
theorem store_retrieve_correct (s : ContractState) (value : Uint256) :
  let s' := (store value).run s |>.2
  let result := retrieve.run s' |>.1
  result = value := by
  -- Machine-checked proof validates correctness
```

## ‚úÖ Proven Properties (SimpleStorage)

- **Basic Correctness**: store‚Üíretrieve roundtrip works
- **Isolation**: Storage operations don't interfere between slots
- **State Preservation**: Operations maintain well-formed state
- **Specification Compliance**: Implementation meets formal spec

[See complete list of 11 theorems](/verification)

## üìö Documentation

- **[Verification Guide](/verification)** - Formal proofs and theorems
- **[Research Log](/research)** - Complete findings from 7 iterations
- **[Iteration Summaries](/iterations)** - Detailed summary of each iteration
- **[Examples](/examples)** - 7 contracts demonstrating patterns
- **[Core Architecture](/core)** - Understanding the 82-line core

## ü§ñ For AI Agents

This documentation is AI-friendly:
- **Raw Markdown**: Request any page with `.md` extension or `?format=md`
- **Complete Docs**: Get all docs concatenated at `/api/docs/_all`
- **Document Index**: JSON list of all docs at `/api/docs/_index`
- **Auto-Detection**: AI user agents automatically get markdown

Example: `curl https://dumbcontracts.com/research.md`

## ‚ú® Design Principles

1. **Minimalism** - 82-line core, only essentials
2. **Rigor** - Separation of specs, implementations, and proofs
3. **Incremental Verification** - Start simple, build up complexity
4. **Type Safety First** - Catch errors at compile-time
5. **Practicality** - Real contracts with both runtime tests and formal proofs

## üî¨ Research Journey

The project evolved through **7 implementation iterations** + **verification**:

**Implementation (Iterations 1-7):**
1. **Bootstrap** - 58-line minimal core
2. **Counter** - Arithmetic operations
3. **Owned** - Access control (+14 lines)
4. **OwnedCounter** - Pattern composition (0 core changes)
5. **Math Safety Stdlib** - Extensibility (0 core changes)
6. **Mapping Support** - Key-value storage (+13 lines)
7. **SimpleToken** - Realistic token contract (0 core changes)

**Verification (Ongoing):**
- ‚úÖ **SimpleStorage** - 11 theorems proven
- üîÑ **Counter** - Next
- üîú **Owned, SimpleToken** - Future

**Key Insight**: 4 out of 7 implementation iterations required zero core changes, validating the composability approach. Now adding mathematical proofs without changing implementations.

## üìñ Getting Started

Explore the documentation:

- Start with the [Verification Guide](/verification) to see proven theorems
- Read the [Research Log](/research) to understand the design decisions
- Check out the [Examples](/examples) to see the EDSL in action
- Read the [Iteration Summaries](/iterations) for detailed evolution

## üîó Links

- [GitHub Repository](https://github.com/Th0rgal/dumbcontracts)
- [Pull Request #3](https://github.com/Th0rgal/dumbcontracts/pull/3) - Complete iteration work

---

**Built with ‚ù§Ô∏è using Lean 4**

*From runtime confidence to mathematical certainty*
