---
title: Dumb Contracts
description: Minimal Lean 4 EDSL for writing and formally verifying smart contracts
---

import { Callout } from 'nextra/components'

# Dumb Contracts

<Callout type="info">
**Are you an AI?** Check [/llms.txt](/llms.txt) or add `.md` to any page URL to get raw markdown and save tokens.
</Callout>

**212-line Lean 4 EDSL for smart contracts. 252 theorems proven. Zero sorry, zero axioms.**

The core models contract state, storage operations, and `require` guards using an explicit success/revert result type (`ContractResult`). Seven example contracts are implemented and verified with machine-checked proofs covering correctness, conservation laws, and storage isolation.

## How it Works

Contracts are functions from `ContractState` to `ContractResult`. The result type has two constructors: `success` (value + new state) and `revert` (error message + old state). Custom `bind` short-circuits on revert, so do-notation works like Solidity's early returns.

```lean
-- A contract that mints tokens, guarded by onlyOwner
def mint (to : Address) (amount : Uint256) : Contract Unit := do
  onlyOwner
  let currentBalance ← getMapping balances to
  setMapping balances to (currentBalance + amount)
  let currentSupply ← getStorage totalSupply
  setStorage totalSupply (currentSupply + amount)

-- Proven: mint increases the recipient's balance by the minted amount
theorem mint_increases_balance (s : ContractState) (to : Address) (amount : Uint256)
  (h_owner : s.sender = s.storageAddr 0) :
  let s' := ((mint to amount).run s).snd
  s'.storageMap 1 to = s.storageMap 1 to + amount
```

## Contracts

| Contract | Theorems | What's verified |
|----------|----------|-----------------|
| SimpleStorage | 19 | Store/retrieve roundtrip, state isolation |
| Counter | 29 | Arithmetic, composition, decrement-at-zero |
| Owned | 22 | Access control, ownership transfer |
| SimpleToken | 64 | Mint/transfer, supply conservation, storage isolation |
| OwnedCounter | 34 | Cross-pattern composition, ownership transfer lockout |
| Ledger | 40 | Deposit/withdraw/transfer, balance conservation |
| SafeCounter | 30 | Overflow/underflow revert proofs |
| Stdlib/Math | 14 | safeMul/safeDiv correctness |

## Documentation

- **[Verification](/verification)** — All 252 proven theorems
- **[Examples](/examples)** — The 7 contracts
- **[Core](/core)** — How the 212-line core works
- **[Research](/research)** — Design iterations and evolution

## Links

- [GitHub Repository](https://github.com/Th0rgal/dumbcontracts)
